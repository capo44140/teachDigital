---
globs: *.vue,src/components/*.vue,src/services/*.js
description: Optimisations de performance sp√©cifiques √† Vue.js pour TeachDigital
---

# Optimisations de Performance Vue.js - TeachDigital

## Configuration Vite Optimis√©e

### Configuration de build optimis√©e
La configuration Vite dans [vite.config.js](mdc:vite.config.js) inclut des optimisations avanc√©es :

```javascript
// Optimisations Terser activ√©es
terserOptions: {
  compress: {
    drop_console: true,        // Supprimer console.log en production
    drop_debugger: true,       // Supprimer debugger en production
    dead_code: true,           // Supprimer code mort
    unused: true,              // Supprimer variables inutilis√©es
    keep_classnames: true      // Important pour Vue.js
  }
}
```

### Code Splitting Intelligent
- **Vue Vendor Chunk** : Vue.js et son √©cosyst√®me s√©par√©s
- **Database Chunk** : @neondatabase isol√©
- **App Chunk** : Tous les composants et services regroup√©s

## Optimisations Vue.js Sp√©cifiques

### Lazy Loading des Composants
```javascript
// Dans src/main.js - Chargement diff√©r√© des services
const scheduleIdleTask = window.requestIdleCallback || ((cb) => setTimeout(cb, 1))

// Initialisation asynchrone apr√®s le premier rendu
scheduleIdleTask(() => {
  initializeServicesAsync()
})
```

### Composants Optimis√©s
- **PerformanceDashboard** : [src/components/PerformanceDashboard.vue](mdc:src/components/PerformanceDashboard.vue)
- **YouTubeVideoManager** : Chargement diff√©r√© des vid√©os
- **ImageOptimizer** : Optimisation automatique des images

### Gestion d'√âtat Efficace
- Utiliser `shallowRef` pour les objets volumineux
- √âviter les mutations profondes avec `reactive`
- Pr√©f√©rer `computed` pour les calculs co√ªteux

### Services de Performance
- **Cache Service** : [src/services/cachedApiService.js](mdc:src/services/cachedApiService.js)
- **Offline Data Service** : [src/services/offlineDataService.js](mdc:src/services/offlineDataService.js)
- **Mobile Optimization** : [src/services/mobileOptimizationService.js](mdc:src/services/mobileOptimizationService.js)

## Optimisations de Bundle

### Tree Shaking Agressif
- Configuration ESBuild avec `treeShaking: true`
- Exclusion des d√©pendances non utilis√©es
- Minification intelligente des noms

### Chunks Optimis√©s
```javascript
// Strat√©gie de chunks dans vite.config.js
manualChunks: (id) => {
  if (id.includes('node_modules')) {
    if (id.includes('vue') || id.includes('@vue')) {
      return 'vue-vendor'  // Vue.js isol√©
    }
    if (id.includes('@neondatabase')) {
      return 'database'     // Base de donn√©es isol√©e
    }
    return 'vendor'         // Autres d√©pendances
  }
  return 'app'             // Code applicatif
}
```

## M√©triques de Performance

### Scripts de Monitoring
- `pnpm run build:analyze` : Analyse du bundle
- `pnpm run lighthouse` : Audit Lighthouse
- `pnpm run performance:check` : V√©rification compl√®te

### Objectifs de Performance
- **First Contentful Paint** : < 0.5s
- **Time to Interactive** : < 1.5s
- **Bundle Size** : < 250KB
- **Lighthouse Score** : > 90

## Bonnes Pratiques

### Composants Vue
- Utiliser `v-memo` pour les listes volumineuses
- Impl√©menter `v-once` pour le contenu statique
- √âviter les watchers profonds sur de gros objets

### Services
- Charger les services critiques en priorit√©
- Diff√©rer les services non critiques
- Utiliser le cache pour √©viter les requ√™tes r√©p√©t√©es

### Images et Assets
- Optimisation automatique avec Sharp
- Lazy loading des images
- Formats modernes (WebP, AVIF)

## Monitoring en Temps R√©el

### Dashboard de Performance
Le composant [PerformanceDashboard.vue](mdc:src/components/PerformanceDashboard.vue) fournit :
- Temps de chargement des composants
- Statistiques de cache
- M√©triques de bundle
- Tests de performance interactifs

### Logs de Performance
```javascript
// Dans src/main.js
console.log('üöÄ Initialisation asynchrone des services...')
console.log('‚úÖ Profils pr√©charg√©s')
console.log('‚úÖ Services PWA initialis√©s avec succ√®s')
```

## Optimisations Sp√©cifiques TeachDigital

### Reconnaissance Faciale
- Chargement diff√©r√© de Face-API.js (-53% de JavaScript)
- Initialisation uniquement quand n√©cessaire
- Cache des mod√®les de reconnaissance

### YouTube Integration
- Chargement diff√©r√© des vid√©os
- Optimisation des thumbnails
- Cache des m√©tadonn√©es vid√©o

### PWA Features
- Service Worker optimis√©
- Cache intelligent avec revalidation
- Mise √† jour transparente des ressources